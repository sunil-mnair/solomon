<html>

    <head>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Fun with Games - EIBFS</title>
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css">
      <link type="text/css" href="{{url_for('static',filename='css/game.css')}}" rel="stylesheet">

        
        <!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=UA-157380323-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-157380323-1');
</script> -->

        
      <style>
        @import url('https://fonts.googleapis.com/css2?family=Play:wght@700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Varela+Round&display=swap');
        /* @import url('game.css'); */
        
        
        .minesweeper{
          background-color: white;
          /* background-image: linear-gradient(315deg, #a40606 0%, #d98324 74%); */

        }

        .game-container{
          display: flex;
          flex-direction: column;
          background-color: white;
          
        }

        .play{
          font-family: 'Play', sans-serif;
          text-align: center;
        }

        
        .game{
        background-color: #b8c6db;
        background-image: linear-gradient(315deg, #b8c6db 0%, #f5f7fa 74%);
        /* background-image: url('https://images.pexels.com/photos/281260/pexels-photo-281260.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500');
        background-size:cover; */
        width: 450px;
        height: 300px;
        padding: 40px;
        border-radius: 5%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-self: center;
        margin-bottom: 50px;
        }

              
        .grid{
        display: flex;
        }
        
        .box{
        width: 150px;
        height: 150px;
        border: 1px solid black;
        background-color: rgba(0,0,0,.5);  
        }
        
        h5{
          cursor: pointer;
        }
        
        .legend{
          display: flex;
          justify-content: center;
          align-items: center;
          
        }
        
        .lg{
        padding: 10px;
        }
        
        
        
        .buttons{
          display: flex;
          justify-content: center;
        }
        
        button{
          padding: 10px;
          border-radius: 15px;
          margin-right: 10px;
          margin-bottom: 10px;
        }

        button:hover{
          background-color: #2048a3;
          color: white;
        }
        
        
        @media only screen and (max-width: 600px){
        
        h1{
          font-size: 2.5em;
        }
        .header img{
          transform: scale(.8);
        }
        

               
        .game{
        width: 300px;
        height: 200px;
        padding: 15px;
        
        }
        
        .box{
        width: 100px;
        height: 100px;
        border: 1px solid black;
        }
        
        }
        
      </style>
      
    </head>
    <body id="body" class="minesweeper">
      
      <div class="container">
        <div class="header">
          <!-- <a href="https://www.penroselearning.com"><img src="https://static1.squarespace.com/static/5c83dafbd7819e5f5559e500/t/5ef6402f6ad4cb3b5272886d/1611330330476/?format=150w"/></a> -->
        </div>
      
        <!-- <h1>The Minesweeper</h1> -->
        <!-- <div class="instructions"> -->
          
          <!-- <h3>Game Instructions</h3>
          <ul>
            <li>Click the Images </li>
            <li>You have <b>3 Safety Tokens</b> available. Use them wisely.</li>
          </ul> -->
        <!-- </div> -->


        <div class="game-container">
        

        <div class="legend play">
          <!-- <div class="lg safe"></div>
          <div class="lg safe-txt">Safe</div>
          
          <div class="lg mine" style="background-image: url('https://icon-library.com/images/mine-icon/mine-icon-25.jpg');"></div>
          <div class="lg mine-txt">Mine</div> -->
          
        
          <h3 class="lg points-txt play" id="article" style="color: darkgreen"></h3>
        </div>
        
        <h2 id="message" class="play" style="color:green"></h2>
        <h3 id="question" class="play"></h3>
        <p id="points" class="play" style="color:blue;"></p>

        <div class="buttons">
        <button id="start" class="play" onclick="gameStart()">Start Game</button>
        <button id="restart" class="play" style="display:none" onclick="gameRestart()">Restart</button>
        <button id="next" class="play" style="display:none" onclick="nextRound()">Next Round</button>
        <button id="token" class="play" style="display:none;background-color: green;color:white;" onclick="token()">3 Safety Tokens</button>
      
        </div>
        
        <div class="legend mines" id="mines_legend" style="display:none;">
        
        </div>
      
        
      <div id="game" class="game">
        <div class="grid">
        <div class="box" id="outlook" onclick="setBgColor(this)"></div>
        <div class="box" id="word" onclick="setBgColor(this)"></div> 
        <div class="box" id="powerpoint" onclick="setBgColor(this)"></div> 
        
        </div>
        <div class="grid">
        <div class="box" id="msexcel" onclick="setBgColor(this)"></div>
        <div class="box" id="access" onclick="setBgColor(this)"></div> 
        <div class="box" id="python" onclick="setBgColor(this)"></div> 
        
        </div>
        <!-- <div class="grid">
        <div class="box" id="nine" onclick="setBgColor(this)"></div>
        <div class="box" id="ten" onclick="setBgColor(this)"></div> 
        <div class="box" id="eleven" onclick="setBgColor(this)"></div> 
        <div class="box" id="twelve" onclick="setBgColor(this)"></div> 
        
        </div> -->
        
        <!-- <div class="grid">
        <div class="box" id="thirteen" onclick="setBgColor(this)"></div>
        <div class="box" id="fourteen" onclick="setBgColor(this)"></div> 
        <div class="box" id="fifteen" onclick="setBgColor(this)"></div> 
        <div class="box" id="sixteen" onclick="setBgColor(this)"></div> 
        
        </div> -->
      </div> 
        </div>
      
       

      </div>
      
      <script>
      
      var round;
      var victorySound;
      var mineSound;
      var points;
      var rdm;
      var num_mines;
      var mines;
      var game_points;
      var tokens;
      var current_question;
    //   var terrian;
    //   terrain = ['https://github.com/penroselearning/curriculum/raw/master/1.png',
    //   'https://github.com/penroselearning/curriculum/raw/master/2.png',
    //   'https://github.com/penroselearning/curriculum/raw/master/3.png',
    //   'https://github.com/penroselearning/curriculum/raw/master/4.png',
    //   'https://github.com/penroselearning/curriculum/raw/master/5.png',
    //   'https://github.com/penroselearning/curriculum/raw/master/6.png'
    //]

      mines = [];
      victorySound = new Audio('https://github.com/penroselearning/curriculum/raw/master/audio/tada.mp3');
      mineSound = new Audio('https://github.com/penroselearning/curriculum/raw/master/audio/mine_explode.mp3')
      
      blockClicks()
      
      boxes = ['outlook','word','powerpoint','msexcel','access','python']
      
      questions = ['Click the Data Tools you are familiar with. Each Data Tool has a message waiting for you.']

      data_tools = {
'outlook':[5,'The email program Outlook help us to stay organised with the data we handle'],
'word':[5,'MS Word helps structure our reports in a legible manner, this is a useful skill while managing data as well'],
'powerpoint':[5,'MS Powerpoint assists in creative presentation of information, this is a useful skill while presentaing data'],
'msexcel':[30,'MS Excel is the most popular and commonly used tool for working with data for beginners and intermediate users'],
'access':[20,'MS Access is a simple desktop database with which you can build simple data applications'],
'python':[35,'Python is a Programming language that has taken the world of Data Analytics by storm']
}
      function gameStart(){
          round = 1;
          points = 0;
          game_points = 0;
          mines = [];
          tokens = 3;
          
          //document.getElementById("game").style.backgroundImage = "url("+terrain[0]+")";

          document.getElementById("points").innerHTML = `Data Literacy Points ${game_points}/100`;
          // document.getElementById("round").innerHTML = `Round ${round}`;

          
          mineLegend();
          minePlacement();
        
          enableClicks();
          setImages(); 
          document.getElementById("start").style.display = 'none';
          document.getElementById("restart").style.display = 'block';
          document.getElementById("token").style.display = 'none';
      
      }

      // document.addEventListener('readystatechange', () => {    
      //   if (document.readyState == 'complete') gameStart();
      // });


      function mineLegend(){

          const myNode = document.getElementById("mines_legend");
          while (myNode.firstChild) {
              myNode.removeChild(myNode.lastChild);
          }

          for(var i = 0; i < round; i++) {
          var divBlock = document.createElement("div");                
          divBlock.className = "lg mine";
          
          document.getElementById("mines_legend").appendChild(divBlock);
    }
      }
      
      function minePlacement(){
        var i;
        num_mines = [];
        mines = [];
        for(i=0; i < round;i++){
          
          mine = Math.round(Math.random() * 15) + 1;

          while (num_mines.includes(mine)) {
              mine = Math.round(Math.random() * 15) + 1;
          }

          num_mines.push(mine);
          mines.push(boxes[num_mines[i]-1])
        }
        
      //   document.getElementById("mines").innerHTML = num_mines + mines;

        
      }
        
        
        function blockClicks(){
          // document.getElementById("game").style.backgroundColor = 'grey';
          
          document.getElementById("token").style.pointerEvents = 'none';

          var x = document.getElementsByClassName("box");
            var i;
            for (i = 0; i < x.length; i++) {
              x[i].style.pointerEvents = 'none';
            }
        }
        
        function enableClicks(){
          
          checkTokens()

          document.getElementById("game").style.backgroundColor = 'rgba(0,0,0,.5)';
          
          document.getElementById("token").style.pointerEvents = 'auto';

          var x = document.getElementsByClassName("box");
            var i;
            for (i = 0; i < x.length; i++) {
              x[i].style.pointerEvents = 'auto';
              x[i].style.backgroundColor = 'rgba(0,0,0,.5)';
              x[i].style.backgroundImage = 'none';
            }
        }
        
        function setImages(){

            document.getElementById("question").innerHTML = questions[round-1];

            var i;
            for (i = 0; i < boxes.length; i++) {
                document.getElementById(boxes[i]).style.backgroundSize = 'contain';
            }

            if (round == 1){
                var i;
                for (i = 0; i < boxes.length; i++) {
                    document.getElementById(boxes[i]).style.backgroundImage = `url('static/images/${Object.keys(data_tools)[i]}.png')`;
                }   
            }
            
            
            // document.getElementById("one").style.backgroundSize = 'contain';

        }
        
        function setBgColor(boxColor)
        {
          if (round == 1){
              current_question = data_tools
          }
          

          if (Object.keys(current_question).includes(boxColor.id)){
            // victorySound.play();
            boxColor.style.pointerEvents = 'none';
            boxColor.style.backgroundColor = 'rgba(0,0,0,.1)';
            // boxColor.style.backgroundImage = "url('static/images/correct.gif')";
            points++;
            game_points = game_points + data_tools[boxColor.id][0];
            document.getElementById("points").innerHTML = `Data Literacy Points ${game_points}/100`;
            document.getElementById("article").innerHTML = data_tools[boxColor.id][1];
            
          }
          
          if(game_points == 100){
              // victorySound.play();
              // game_points = game_points + 5;
              
              document.getElementById("points").innerHTML = `Points ${game_points}`;
              blockClicks();
              document.getElementById("next").style.display = 'block';
              points = 0;
              document.getElementById("token").style.display = 'none';

              
              if (round == 1){
                  gameOver();
              }
              else{
                nextRound()
              }


          }
          
        }
        
        function gameRestart(){

          game_points = 0;
          points = 0;
          document.getElementById("points").innerHTML = `Data Literacy Points ${game_points}/100`;
          document.getElementById("message").innerHTML = '';
          document.getElementById("article").innerHTML = '';
        //   document.getElementById("token").innerHTML = `${tokens} Safety Tokens`;
        //   document.getElementById("token").style.display = 'block';
          enableClicks();
          mineLegend();
          minePlacement();
          setImages();
        }
        
        function nextRound(){
          
        //   if (round >= 5){
        //     if (tokens >= 1){
        //       tokens = 3;
        //       document.getElementById("token").innerHTML = `${tokens} Safety Tokens`;
        //     }
        //   }

          //document.getElementById("game").style.backgroundImage = "url("+terrain[round]+")";

          document.getElementById("next").style.display = 'none';
        //   document.getElementById("token").style.display = 'block';

          round = round + 1;
          // document.getElementById("round").innerHTML = `Round ${round}`
          document.getElementById("game").style.backgroundColor = 'rgba(0,0,0,.5)';
          
          var x = document.getElementsByClassName("box");
            var i;
            for (i = 0; i < x.length; i++) {
              x[i].style.backgroundColor = 'rgba(0,0,0,.5)';
            }
          
            
          mineLegend();
          minePlacement();
          enableClicks();
          setImages();
          

        }

        function checkTokens(){
          if (tokens == 0){
              document.getElementById("token").style.display = 'none';
          }
        }

        function token(){
          
          tokens = tokens - 1;
          points++;
          game_points++;

          checkTokens()
          
          document.getElementById("points").innerHTML = `Points ${game_points}`;
          document.getElementById("token").innerHTML = `${tokens} Safety Tokens`;

          var x = document.getElementsByClassName("box");
            var i;
            var spare = [];
            console.log(mines);
            for (i = 0; i < x.length; i++) {
              console.log(document.getElementById(x[i].id).style.backgroundColor);
              if (document.getElementById(x[i].id).style.backgroundImage == 'none' && !mines.includes(x[i].id)){
                spare.push(x[i]);
                
              }
              else{
                // console.log(x[i].id);
                console.log("None");
              };


            }
            
            spare[Math.floor(Math.random() * spare.length)].style.backgroundColor = 'rgba(0,0,0,.1)';

            

        }

        
        function displayMines(){
          var x = document.getElementsByClassName("box");
            var i;
            for (i = 0; i < x.length; i++) {
              if (mines.includes(x[i].id)){
                  document.getElementById(x[i].id).style.backgroundColor = 'red';
                  document.getElementById(x[i].id).style.backgroundImage = "url('https://icon-library.com/images/mine-icon/mine-icon-25.jpg')";
                  document.getElementById(x[i].id).style.backgroundSize = "contain";
              };
            }
        }


        function gameOver(){
            blockClicks();
            
            document.getElementById("message").innerHTML = `Congrats!! You are on the right path to get ahead on Data Skills!!`;
            document.getElementById("message").style.color = "green";
              
            document.getElementById("next").style.display = "none";
            document.getElementById("restart").style.display = "block";
        }

      //   function saveScore(){
      //     player = {name: "John", score: 31, city: "New York"};

      //     myJSON = JSON.stringify(player);
      //     localStorage.setItem("topscore.json", myJSON);

      //     // Retrieving data:
      //     text = localStorage.getItem("topscore.json");
      //     player = JSON.parse(text);
      //     document.getElementById("demo").innerHTML = `obj.name;
      //   }

      </script>
      
    </body>
  </html>